#!/bin/bashn# update-advanced-prp-template.sh - Update advanced PRP template v3 for project contextnnif [ -z "$1" ]; thenn    echo "‚ùå ERROR: Language parameter required"n    echo "Usage: ./update-advanced-prp-template.sh <language>"n    exit 1nfinnLANGUAGE="$1"necho "üîÑ Updating advanced PRP template v3 for $LANGUAGE..."necho "   Using implementation-focused template with validation loops"nn# Check if advanced template v3 existsnif [ ! -f "templates/prp-base.md" ]; thenn    echo "‚ùå ERROR: Advanced PRP template v3 not found!"n    echo "   Expected: templates/prp-base.md"n    exit 1nfinn# Check if language hints existnLANGUAGE_HINTS="templates/language-hints/$LANGUAGE.md"nif [ ! -f "$LANGUAGE_HINTS" ]; thenn    echo "   ‚ö†Ô∏è  No specific hints for $LANGUAGE, using common patterns"n    LANGUAGE_HINTS="templates/language-hints/common.md"nfinn# Create updated template directorynmkdir -p "templates/updated"nn# Copy advanced template v3 to updated versionncp "templates/prp-base.md" "templates/prp-base-advanced-v3-updated.md"nn# Extract language-specific patterns and update advanced templatenif [ -f "$LANGUAGE_HINTS" ]; thenn    echo "   üìù Applying $LANGUAGE-specific patterns to advanced template..."n    n    # Add language-specific implementation patternsn    cat >> "templates/prp-base-advanced-v3-updated.md" << EOFnn## üéØ Language-Specific Implementation Patterns for $LANGUAGEnEOFn    n    # Extract and add relevant patterns for advanced template v3n    if grep -q "Common Patterns" "$LANGUAGE_HINTS"; thenn        echo "   ‚úÖ Added common patterns"n        sed -n "/^## Common Patterns/,/^## /p" "$LANGUAGE_HINTS" | head -n -1 >> "templates/prp-base-advanced-v3-updated.md"n    fi n    n    if grep -q "Project Structure" "$LANGUAGE_HINTS"; thenn        echo "   ‚úÖ Added project structure"n        sed -n "/^## Project Structure/,/^## /p" "$LANGUAGE_HINTS" | head -n -1 >> "templates/prp-base-advanced-v3-updated.md"n    fi n    n    if grep -q "Common Dependencies" "$LANGUAGE_HINTS"; thenn        echo "   ‚úÖ Added common dependencies"n        sed -n "/^## Common Dependencies/,/^## /p" "$LANGUAGE_HINTS" | head -n -1 >> "templates/prp-base-advanced-v3-updated.md"n    fi n    n    if grep -q "Testing Patterns" "$LANGUAGE_HINTS"; thenn        echo "   ‚úÖ Added testing patterns"n        sed -n "/^## Testing Patterns/,/^## /p" "$LANGUAGE_HINTS" | head -n -1 >> "templates/prp-base-advanced-v3-updated.md"n    fi n    n    if grep -q "Error Handling Patterns" "$LANGUAGE_HINTS"; thenn        echo "   ‚úÖ Added error handling patterns"n        sed -n "/^## Error Handling Patterns/,/^## /p" "$LANGUAGE_HINTS" | head -n -1 >> "templates/prp-base-advanced-v3-updated.md"n    fi nfi nn# Add common patterns if not already addednif [ "$LANGUAGE" != "COMMON" ] && [ -f "templates/language-hints/common.md" ]; thenn    echo "   üìù Adding universal best practices..."n    cat >> "templates/prp-base-advanced-v3-updated.md" << EOFnn## üåü Universal Best Practices for Advanced PRP v3nEOFn    sed -n "/^## Universal Best Practices/,/^## /p" "templates/language-hints/common.md" | head -n -1 >> "templates/prp-base-advanced-v3-updated.md"nfi nn# Add advanced PRP v3 specific enhancementsncat >> "templates/prp-base-advanced-v3-updated.md" << EOFnn## üöÄ Advanced PRP v3 Enhancementsn### Implementation Precisionn- **Task-specific guidance** with exact file pathsn- **Pattern references** to existing codebasen- **Validation loops** at 4 comprehensive levelsn- **Anti-pattern prevention** with specific examplesnn### Cursor IDE Integrationn- **Enhanced workflow** with IDE rulesn- **Automatic validation** during developmentn- **Pattern enforcement** for consistencyn- **Quality gates** at every stepnn### Validation Loop Systemn- **Level 1**: Syntax, style, type checkingn- **Level 2**: Unit tests and component validationn- **Level 3**: Integration testing and system validationn- **Level 4**: Creative validation and domain-specific testingnnEOFnn# Update template metadatanecho "   üìù Updating advanced template metadata..."nCURRENT_DATE=$(date +%Y-%m-%d)nsed -i "s/[LANGUAGE]/$LANGUAGE/g" "templates/prp-base-advanced-v3-updated.md"nsed -i "s/[DATE]/$CURRENT_DATE/g" "templates/prp-base-advanced-v3-updated.md"nsed -i "s/[FRAMEWORK]/$(echo $LANGUAGE | tr '[:upper:]' '[:lower:]')/g" "templates/prp-base-advanced-v3-updated.md"nn# Create versioned template if significant changesnif [ ! -d "templates/versioned-templates" ]; thennmkdir -p "templates/versioned-templates"nfi nn# Check if this is a new language or significant updatenif [ ! -f "templates/versioned-templates/$LANGUAGE-advanced-v3-template-v1.md" ]; thenn    echo "   üíæ Creating versioned advanced template v3 for $LANGUAGE..."n    cp "templates/prp-base-advanced-v3-updated.md" "templates/versioned-templates/$LANGUAGE-advanced-v3-template-v1.md"n    echo "   ‚úÖ Saved as: $LANGUAGE-advanced-v3-template-v1.md"nfinnif [ $? -eq 0 ]; thenn    echo "‚úÖ Advanced PRP template v3 updated successfully for $LANGUAGE"n    echo "   üìÑ Updated template: templates/prp-base-advanced-v3-updated.md"n    echo "   üéØ Features: Implementation precision, validation loops, anti-patterns"n    if [ -f "templates/versioned-templates/$LANGUAGE-advanced-v3-template-v1.md" ]; thenn        echo "   üíæ Versioned template: templates/versioned-templates/$LANGUAGE-advanced-v3-template-v1.md"n    fi nelsen    echo "‚ùå ERROR: Failed to update advanced PRP template v3"n    exit 1nfi